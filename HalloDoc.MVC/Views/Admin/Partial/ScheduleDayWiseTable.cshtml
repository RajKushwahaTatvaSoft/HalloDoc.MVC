@model ShiftTableViewModel
<div class="p-0 admin-dashboard container-fluid mt-4 table-responsive">
    <table class="table mt-4  table-bordered">
        <thead class="darkgrey-back ">
            <tr>
                <th class="p-0 align-items-center"><span class="align-items-center">Provider Profile</span></th>
                @foreach (var hour in Model.Hours)
                {
                    <th>@hour</th>
                }
            </tr>
        </thead>
        <tbody>
            <tr style="background-color:lightpink">
                <td style="background-color:white;">Coverage</td>
                @foreach (var hour in Model.hourTime)
                {
                    <td></td>
                }
            </tr>
            @foreach (var p in Model.physicians)
            {
                <tr>
                    <td>
                        <img src="~/document/physician/@p.Physicianid/ProfilePhoto.jpg" class="rounded-circle " style="height:30px; width:30px;" />
                        <span class="laptop">@p.Firstname @p.Lastname</span>
                    </td>

                    @foreach (var hour in Model.hourTime)
                    {
                        int count = 1;
                        int count2 = 1;
                        @for (int i = 0; i < Model.Shifts.Count; i++)
                        {
                            @if (Model.Shifts[i].StartTime.Hour >= TimeOnly.Parse(hour).Hour && Model.Shifts[i].EndTime.Hour <= TimeOnly.Parse(hour).Hour + 1 && Model.Shifts[i].PhysicianId == p.Physicianid)
                            {
                                @if (Model.Shifts[i].Status == 1 && Model.Shifts[i].shiftDate >= DateTime.Now)
                                {
                                    <td class="align-content-center" style="background-color:lightgreen">
                                        <a data-bs-toggle="modal" data-bs-target="#ViewShiftModal" class="text-light align-content-center">

                                            <svg fill="#ffffff" height="20px" width="20px" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" xmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 512 512">
                                                <g>
                                                    <path d="m494.8,241.4l-50.6-49.4c-50.1-48.9-116.9-75.8-188.2-75.8s-138.1,26.9-188.2,75.8l-50.6,49.4c-11.3,12.3-4.3,25.4 0,29.2l50.6,49.4c50.1,48.9 116.9,75.8 188.2,75.8s138.1-26.9 188.2-75.8l50.6-49.4c4-3.8 11.7-16.4 0-29.2zm-238.8,84.4c-38.5,0-69.8-31.3-69.8-69.8 0-38.5 31.3-69.8 69.8-69.8 38.5,0 69.8,31.3 69.8,69.8 0,38.5-31.3,69.8-69.8,69.8zm-195.3-69.8l35.7-34.8c27-26.4 59.8-45.2 95.7-55.4-28.2,20.1-46.6,53-46.6,90.1 0,37.1 18.4,70.1 46.6,90.1-35.9-10.2-68.7-29-95.7-55.3l-35.7-34.7zm355,34.8c-27,26.3-59.8,45.1-95.7,55.3 28.2-20.1 46.6-53 46.6-90.1 0-37.2-18.4-70.1-46.6-90.1 35.9,10.2 68.7,29 95.7,55.4l35.6,34.8-35.6,34.7z" />
                                                </g>
                                            </svg>
                                        </a>
                                    </td>
                                }
                                else if (Model.Shifts[i].Status == 1 && Model.Shifts[i].shiftDate <= DateTime.Now)
                                {
                                    <td class="align-content-center" style="background-color:lightgreen">
                                        <a class="text-light align-content-center">

                                            <svg fill="#ffffff" height="20px" width="20px" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" xmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 512 512">
                                                <g>
                                                    <path d="m494.8,241.4l-50.6-49.4c-50.1-48.9-116.9-75.8-188.2-75.8s-138.1,26.9-188.2,75.8l-50.6,49.4c-11.3,12.3-4.3,25.4 0,29.2l50.6,49.4c50.1,48.9 116.9,75.8 188.2,75.8s138.1-26.9 188.2-75.8l50.6-49.4c4-3.8 11.7-16.4 0-29.2zm-238.8,84.4c-38.5,0-69.8-31.3-69.8-69.8 0-38.5 31.3-69.8 69.8-69.8 38.5,0 69.8,31.3 69.8,69.8 0,38.5-31.3,69.8-69.8,69.8zm-195.3-69.8l35.7-34.8c27-26.4 59.8-45.2 95.7-55.4-28.2,20.1-46.6,53-46.6,90.1 0,37.1 18.4,70.1 46.6,90.1-35.9-10.2-68.7-29-95.7-55.3l-35.7-34.7zm355,34.8c-27,26.3-59.8,45.1-95.7,55.3 28.2-20.1 46.6-53 46.6-90.1 0-37.2-18.4-70.1-46.6-90.1 35.9,10.2 68.7,29 95.7,55.4l35.6,34.8-35.6,34.7z" />
                                                </g>
                                            </svg>
                                        </a>
                                    </td>
                                }

                                else
                                {
                                    <td style="background-color:lightpink">
                                        <a class="text-light">
                                            <svg fill="#ffffff" height="20px" width="20px" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" xmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 512 512">
                                                <g>
                                                    <path d="m494.8,241.4l-50.6-49.4c-50.1-48.9-116.9-75.8-188.2-75.8s-138.1,26.9-188.2,75.8l-50.6,49.4c-11.3,12.3-4.3,25.4 0,29.2l50.6,49.4c50.1,48.9 116.9,75.8 188.2,75.8s138.1-26.9 188.2-75.8l50.6-49.4c4-3.8 11.7-16.4 0-29.2zm-238.8,84.4c-38.5,0-69.8-31.3-69.8-69.8 0-38.5 31.3-69.8 69.8-69.8 38.5,0 69.8,31.3 69.8,69.8 0,38.5-31.3,69.8-69.8,69.8zm-195.3-69.8l35.7-34.8c27-26.4 59.8-45.2 95.7-55.4-28.2,20.1-46.6,53-46.6,90.1 0,37.1 18.4,70.1 46.6,90.1-35.9-10.2-68.7-29-95.7-55.3l-35.7-34.7zm355,34.8c-27,26.3-59.8,45.1-95.7,55.3 28.2-20.1 46.6-53 46.6-90.1 0-37.2-18.4-70.1-46.6-90.1 35.9,10.2 68.7,29 95.7,55.4l35.6,34.8-35.6,34.7z" />
                                                </g>
                                            </svg>
                                        </a>
                                    </td>

                                }
                                count2 = count + 1;
                            }
                        }
                        @if (count2 == count)
                        {
                            <td></td>
                        }


                    }




                </tr>
            }
        </tbody>
    </table>
</div>


<script>
    $('.viewshift-btn').click(function () {
        console.log('view shift btn');

        var Id = $(this).data("id");
        console.log('shift id ' + Id);
        $('#EditshiftId').val(Id);

        var physicianid = $(this).data("phyid");
        console.log('phyId' + physicianid);
        $('#physicianList2').val(physicianid);

        var startTime = $(this).data("time");
        $('#EditshiftstartTime').val(startTime);

        var endTime = $(this).data("endtime");
        $('#EditshiftendTime').val(endTime);

        var shiftdate = $(this).data("date");
        $('#Editshiftdate').val(shiftdate);
        // console.log($('#EditshiftId').val());
        // console.log($('#physicianList2').val());
        // console.log($('#EditshiftendTime').val());


    });


    $('#viewShift-save-btn').click(function () {
        debugger;
        console.log('view save btn');
        var phyid = $('#physicianList2').val();
        console.log(phyid);
        var shift = $('#EditshiftId').val();
        console.log(shift);
        var start = $('#EditshiftstartTime').val();
        console.log(start);

        var end = $('#EditshiftendTime').val();
        console.log(end);
        var shiftdate = $('#Editshiftdate').val();


        $.ajax({
            url: "/Admin/EditShift",
            data: { shiftId: shift, startTime: start, endTime: end, date: shiftdate },
            type: 'POST',
            success: function (result) {
                location.reload();
            },
            error: function (error) {
                console.log(error);
                alert('Error Cancelling Request')
            },
        });
    });

</script>